{% extends "base.html" %}

{% block title %}é¦–é¡µ - Markdown to DOCX Converter{% endblock %}

{% block content %}
<div class="hero">
    <h2>å°† Markdown è½¬æ¢ä¸ºç²¾ç¾çš„ DOCX æ–‡æ¡£</h2>
    <p>æ”¯æŒæ ‡é¢˜ã€åˆ—è¡¨ã€è¡¨æ ¼ã€ä»£ç å—ã€å›¾ç‰‡ç­‰ä¸°å¯Œçš„Markdownè¯­æ³•</p>
</div>

<div class="converter-section">
    <div class="tabs">
        <button class="tab-button active" onclick="switchTab('text')">æ–‡æœ¬è¾“å…¥</button>
        <button class="tab-button" onclick="switchTab('file')">æ–‡ä»¶ä¸Šä¼ </button>
    </div>

    <form id="converter-form" action="{{ url_for('convert') }}" method="post" enctype="multipart/form-data">
        <!-- æ–‡æœ¬è¾“å…¥æ¨¡å¼ -->
        <div id="text-tab" class="tab-content active">
            <div class="form-group">
                <label for="markdown">Markdown å†…å®¹</label>
                <textarea
                    id="markdown"
                    name="markdown"
                    placeholder="åœ¨è¿™é‡Œè¾“å…¥ Markdown å†…å®¹...

ç¤ºä¾‹ï¼š
# æ ‡é¢˜

è¿™æ˜¯ä¸€ä¸ª**ç²—ä½“**æ–‡æœ¬å’Œ*æ–œä½“*æ–‡æœ¬ã€‚

## åˆ—è¡¨
- é¡¹ç›® 1
- é¡¹ç›® 2

## ä»£ç 
```python
print('Hello World!')
```

| è¡¨æ ¼ | ç¤ºä¾‹ |
|------|------|
| æ•°æ® | å†…å®¹ |"
                    rows="20"
                    required
                ></textarea>
            </div>
        </div>

        <!-- æ–‡ä»¶ä¸Šä¼ æ¨¡å¼ -->
        <div id="file-tab" class="tab-content">
            <div class="form-group">
                <label for="file">é€‰æ‹© Markdown æ–‡ä»¶</label>
                <input
                    type="file"
                    id="file"
                    name="file"
                    accept=".md,.markdown,.txt"
                >
                <small>æ”¯æŒ .md, .markdown, .txt æ–‡ä»¶ï¼Œæœ€å¤§ 16MB</small>
            </div>
        </div>

        <div class="form-actions">
            <button type="submit" class="btn btn-primary">
                <span class="icon">ğŸ“¥</span>
                è½¬æ¢ä¸º DOCX
            </button>
            <button type="button" class="btn btn-secondary" onclick="showPreview()">
                <span class="icon">ğŸ‘ï¸</span>
                é¢„è§ˆæ•ˆæœ
            </button>
        </div>
    </form>
</div>

<div class="features">
    <h3>æ ¸å¿ƒç‰¹æ€§</h3>
    <div class="feature-grid">
        <div class="feature-item">
            <span class="feature-icon">ğŸ“</span>
            <h4>å®Œæ•´ Markdown æ”¯æŒ</h4>
            <p>æ”¯æŒæ ‡å‡† Markdown è¯­æ³•ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€åˆ—è¡¨ã€é“¾æ¥ã€å›¾ç‰‡ç­‰</p>
        </div>
        <div class="feature-item">
            <span class="feature-icon">ğŸ¨</span>
            <h4>ç¾è§‚æ’ç‰ˆ</h4>
            <p>è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šæ ¼å¼çš„ Word æ–‡æ¡£ï¼Œä¿æŒè‰¯å¥½çš„æ’ç‰ˆæ•ˆæœ</p>
        </div>
        <div class="feature-item">
            <span class="feature-icon">âš¡</span>
            <h4>å¿«é€Ÿè½¬æ¢</h4>
            <p>æœ¬åœ°å¤„ç†ï¼Œæ— éœ€ç½‘ç»œï¼Œè½¬æ¢é€Ÿåº¦å¿«ï¼Œæ”¯æŒå¤§æ–‡ä»¶</p>
        </div>
        <div class="feature-item">
            <span class="feature-icon">ğŸ›¡ï¸</span>
            <h4>éšç§ä¿æŠ¤</h4>
            <p>å®Œå…¨æœ¬åœ°å¤„ç†ï¼Œä¸ä¸Šä¼ æ–‡ä»¶ï¼Œä¿æŠ¤æ‚¨çš„éšç§å®‰å…¨</p>
        </div>
    </div>
</div>

<!-- é¢„è§ˆæ¨¡æ€æ¡† -->
<div id="preview-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>æ–‡æ¡£é¢„è§ˆ</h3>
            <span class="modal-close" onclick="closePreview()">&times;</span>
        </div>
        <div class="modal-body">
            <form id="preview-form" action="{{ url_for('preview') }}" method="post" enctype="multipart/form-data">
                <div class="preview-input">
                    <textarea id="preview-markdown" name="markdown" placeholder="è¾“å…¥Markdownå†…å®¹è¿›è¡Œé¢„è§ˆ..." rows="15"></textarea>
                    <div class="preview-actions">
                        <button type="submit" class="btn btn-primary">ç”Ÿæˆé¢„è§ˆ</button>
                        <button type="button" class="btn btn-secondary" onclick="syncPreviewContent()">ä»ä¸Šæ–¹åŒæ­¥</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// æ ‡ç­¾åˆ‡æ¢åŠŸèƒ½
function switchTab(tabName) {
    // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });

    // ç§»é™¤æ‰€æœ‰æ ‡ç­¾æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active');
    });

    // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
    document.getElementById(tabName + '-tab').classList.add('active');

    // æ¿€æ´»å¯¹åº”çš„æ ‡ç­¾æŒ‰é’®
    event.target.classList.add('active');
}

// é¢„è§ˆåŠŸèƒ½
function showPreview() {
    document.getElementById('preview-modal').style.display = 'block';
}

function closePreview() {
    document.getElementById('preview-modal').style.display = 'none';
}

// ä»ä¸»è¾“å…¥æ¡†åŒæ­¥å†…å®¹åˆ°é¢„è§ˆ
function syncPreviewContent() {
    const mainContent = document.getElementById('markdown').value;
    document.getElementById('preview-markdown').value = mainContent;
}

// ç‚¹å‡»æ¨¡æ€æ¡†å¤–éƒ¨å…³é—­
window.onclick = function(event) {
    const modal = document.getElementById('preview-modal');
    if (event.target == modal) {
        modal.style.display = 'none';
    }
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // ç»‘å®šæ–‡ä»¶è¾“å…¥å˜åŒ–äº‹ä»¶
    document.getElementById('file').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            // å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æ–‡ä»¶ä¿¡æ¯æ˜¾ç¤º
            console.log('é€‰æ‹©æ–‡ä»¶:', file.name, 'å¤§å°:', (file.size / 1024 / 1024).toFixed(2), 'MB');
        }
    });
});
</script>
{% endblock %}
